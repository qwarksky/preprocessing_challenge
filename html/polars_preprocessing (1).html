<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        const scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          const element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          const hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          const newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((_entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>polars_preprocessing.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>polars preprocessing</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/index-3OIHLLq_.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/preload-helper-g1IWzEZ-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/chunk-LvLJmgfZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/react-XTZdWHwa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/compiler-runtime-QczY1yfQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useEventListener-4mpeqPxW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/react-dom-BZDtXk6t.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/jsx-runtime-DUsrKwmN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Combination-D2HqSOvH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/clsx-FpJB9huX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cn-Cs2e4A8T.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/menu-items-B57SjdWM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/hotkeys-Dh4gy4JD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/button-D8mnDDLX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-Dj-O1Spr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/createLucideIcon-BJ2I6csQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/check-CWbw3kKW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/select-CgZgQ5hV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/multi-map-D3NvLiI9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/chevron-right-B_qBg_RU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dropdown-menu-Ciqx4yT-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/tooltip-DqNvr2Rw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_Uint8Array-BGESiCQL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_getTag-BWqNuuwU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseIsEqual-C8v2yRqO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/jotai-D74Ef_p1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/invariant-Amh6wt4N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/isArrayLikeObject-BkJc8lDE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/merge-5YNOh9ZD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/zod-BBqism5D.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/utils-x9KlwLm7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/requests-THIDPq-F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/once-BxRirs3K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toDate-Y5T6FHPx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/isSymbol-BGkTcW3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toString-DlRqgfqz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseSlice-BoaxdS7L.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_hasUnicode-CNlKPr15.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useLifecycle-8fgb5Nue.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/capitalize-L9-XHPtm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ai-model-dropdown-CO52rzQt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/badge-Cm0WUI-_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/use-toast-DKTyV2AR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/constants-BmIIVBf_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Deferred-9HYzcD3r.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/config-CbG7e0K6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/uuid-B8w6pjWV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/DeferredRequestRegistry-DfLQSvoS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/connection-B11rCPnY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useNonce-D8CLFIrY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/capabilities-Bdlrhekp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/createReducer-VgoBNe3M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-C3a_7WFa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-0z0sEYV-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BzfTz_Dx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DmruaXMM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DU0YrNRK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-_bGPtAsk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DsSBESho.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-B2TjmP7E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BzDb7E9f.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/stex-C4ZxI0N3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cjs-Ba5CQnxe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_arrayReduce-DdxhySYh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/type-kFt-n-jZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseProperty-D0ckTA0L.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toNumber-GB_lFVaq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/now-CAWn5i9V.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/debounce-Bgq-wc7M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toInteger-Cl1doThW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/main-CC_mbgxK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cells-DoKM12vd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/kbd-EdFdwHEs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/renderShortcut-CLenKJO6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useEvent-l9BzRqpK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useDeleteCell-BDBSmjLV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/lazy-Cbg8zRvU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/defaultLocale-8c1ixjJ_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/precisionRound-CQhbsDNz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/defaultLocale-BECdiY5x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/vega-loader.browser-DZ31-605.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/tooltip-CSAGVmjx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ErrorBoundary-6EjkHrSV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/alert-dialog-D9SwG8oA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dialog-BPIq0Dmw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useDebounce-C9S6xmGh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/numbers-BigybruE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/SSRProvider-DlZbKHsu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/context-CO64Gasq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useNumberFormatter-B5HAJDUq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/usePress-DHxqjtDm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/input-CVoLDDk-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ImperativeModal-ameyIrhc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cell-link-BiAu_8pk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/alert-D5BMn3Et.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/links-Iv0WhyKW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/state-i7G4J1VS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/MarimoErrorOutput-Bh7Bgl2Z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/copy-BS3uwoaq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/copy-DhmkXAPp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/copy-icon-Lyk2_Z8G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/spinner-DpaQpaiI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-D1pae9A2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/focus-CyxSol0W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/popover-DZBXSGEz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useRunCells-DT1En-Te.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mode-DKDAYLK9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/purify.es-hXMlfS4W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/RenderHTML-Dlz0Ew2i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/table-CesNYRF-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/tabs-BjAbB8w_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/add-missing-import-DV1FOw9w.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useAsyncData-_-DLduEH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useIframeCapabilities-r0LQMxAQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/LazyAnyLanguageCodeMirror-C7KtNlRp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/error-banner-C9tkg1MX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/formats-C3exma5i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useTheme-DpA-8Qyy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/en-US-Lc4gASCJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/isValid-Cd_L_2Pm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/maps-D4abje2p.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/shim-D-ElLTBO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/download-CCvBQ7qL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/extends-C2lJEiP_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/emotion-is-prop-valid.esm-c4A1huxA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useDateFormatter-BMdQ9MI_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/katex-BmfUoCWW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/marked.esm-idL59iHw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/chunk-T7OEMACY-CdGEwedE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/range-Bbli-TEL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/table-kHJ0xpFt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Output-DxdWGPFi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/name-cell-input-C6ZYU6mN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useHotkey-B0ylhc2m.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-CqHWOZu2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BcLYYUSi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BVXr6b5T.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BrEX5EQl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-CalRK9ms.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-Cc4T7UUX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-D3MC5WiF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DgaCIZAa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-rqHtY98i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-tj-jaP-y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-w7c0BKrD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-CCZcRJI9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-CrDb6akR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/apl-BQt6lLuE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/asciiarmor-BjX7bs0j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/asn1-xn1MtyoW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/brainfuck-BjO-UY1i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/clike-DW9tQWfF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/clojure-BSW96HRx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cmake-C7UlMfz3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cobol-CyWIev3Y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/coffeescript-DTvziYTK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/commonlisp-yMdkdGMi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/crystal-BGnoSp3z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/css-D7fWzevp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cypher-Cr1dl0Qf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/d-C2bS5bA6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/diff-B2mHQyn6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dtd-Cy-lUE7p.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dylan-mm60grwk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ecl-Cqi05Wy1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/eiffel-FkvfLQq7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/elm-Da5txHw0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/erlang-CdnCEH5x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/simple-mode-B185hCuE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/factor-CamlR8EJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/forth-UcMX0m31.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/fortran-DZ_vNVsP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/gas-CM88o6Zj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/gherkin-BhrpTeN9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/groovy-BFju68Wx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/haskell-CrWHY4et.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/haxe-1eKW-tbO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/idl-Do4AwvU2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/javascript-CTXZKRYd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/julia-BRynwHI4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/livescript-ZmIBNA-I.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/lua-mUfZ-MRC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mathematica-Dil5dTHO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mbox-Dnkn9wSr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mirc-auEWieOB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mllike-xVJsauJ8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/modelica-B8kajVDm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mscgen-Bsnta1jn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mumps-CMw16b5q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/nsis-DwPdi8sw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ntriples-O5lQxirn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/octave-CMfAar-E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/oz-CLRI9Qww.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/pascal-D2M_3HBx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/perl-B8lV7aKt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/pig-Bima2bfE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/powershell-v_t41ydu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/properties-ChrStSby.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/protobuf-Bin6kmlf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/pug-UWVdYLYW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/puppet-DYrtWvYn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/python-BuKrulde.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/q-CrXUTiVN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/r-Bk2Tiso2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/rpm-CmmZphz3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ruby-ElyOTVeQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/sas-jE3ZlG0K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/scheme-CZF1tRbv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/shell-LqT3ZqMa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/sieve-y15yT7Pp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/smalltalk-pk5PvsMs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/sparql-DTZ_gfPQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/stylus-CrGj0eNT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/swift-tt3PlBbI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/tcl-1P4b0GMJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/textile-BHDIuMYh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toml-C8qoqk_i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/troff-DMiF5Zmz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ttcn-cfg-qLZtNU-E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ttcn-BAUp3RZn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/turtle-BizIwmKv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/vb-Bn_uCxNL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/vbscript-BTKW8Atx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/velocity-CcB05fpi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/verilog-BWdtOJH8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/vhdl-CzFOaOHx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/webidl-DDEKCqSy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/xquery-BcF6ZhQP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/yacas-BARQAiXa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/z80-DO_Ep0iT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/esm-DnNh7vdQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/objectWithoutPropertiesLoose-DDabolgJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/esm-Crqxhl3F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/trash-Df8Wb7xS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ConsoleOutput-D8ETq-cc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/icons-BgmgMjOV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/blob-LiDbeYko.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/add-cell-with-ai-85tnyxYo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/chart-no-axes-column-BrQ3B3xc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/square-function-D5EEjILG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/spec-DpllSlJD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useInstallPackage-BaAhpZlP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/column-preview-DGBk0umL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useAddCell-DYfGo4T8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toggle-PGHtwx2G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/api-CoLss8_O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/globals-oV9pRUSB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/share-DjbnD3WE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/memoize-DN0TMY36.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/get-CyLJYAfP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseSet-CKSmZC_I.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/utilities.esm-DvrcU9Ky.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/floating-outline-DmCT2Mvg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/eye-off-BUwXWtH0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/plus-CiGrWbgb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/readonly-python-code-CkaJ4Tks.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/file-video-camera-BGBfFNDn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/file-text-O5IflCIn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/file-CqXxt3_J.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/types-BMriRmf-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/label-4Nancvon.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/textarea-BnZHy5Jt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/circle-x-Cc9X6U_B.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/refresh-ccw-aU2rUkrI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/trash-2-Du5ITnDv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/form-600t_Civ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/field-Dov6YyOV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/switch-Ct8mUApv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useBoolean-Dmwks1uh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useDeepCompareMemoize-C8RdAYFq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/types-D0WVpW93.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/prop-types-WJwGTMoZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/es-DAmFxw3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/VisuallyHidden-RqykLBKh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseFlatten-rM2FaX4x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/hasIn-CE-pxQP-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_basePickBy-LbasZ8ix.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/pick-FbHfDtcJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/send-LAFRRDPT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/code-xml-DdSOsi73.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/download-Dmmu2U4a.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/globe-vMZtva7z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/refresh-cw-BOc7UXm9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/settings-DznrHqbd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/square-DhlBDqyx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/triangle-alert-Bf1kg4xT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DL3W3q-2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/bundle.esm-C-9IAWQU.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cells-wU8qigWB.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Output-DUep6sC9.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ConsoleOutput-BFFTcC5Y.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/index-CJU5NUvF.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "polars_preprocessing.py",
            "mode": "read",
            "version": "0.18.4",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "above", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 30, "default_width": "full", "reference_highlighting": true, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "uv"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "native", "width": "full"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "import marimo as mo\nimport polars as pl\nfrom sklearn.preprocessing import MinMaxScaler,StandardScaler, RobustScaler,Normalizer,MaxAbsScaler\nfrom sklearn.preprocessing import OneHotEncoder, OrdinalEncoder\nfrom functools import wraps", "code_hash": "626d46b932cfca07000eaeae14da8b22", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "mo.md(r\"\"\"\n# Loading DataSet\n\"\"\")", "code_hash": "426ddfdb43e6e5fb9e91424ee2083b02", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "MJUe", "name": "_"}, {"code": "pf = pl.read_parquet(\"datasets/taxis_str.parquet\")\npf.describe()", "code_hash": "399e45a1ce8f8282113e7ef0537e2c89", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Detect which encoder Ordinal or OneHot\n* Try feature.n_unique \u003C 10 =\u003E OneHot\n* Try feature.n_unique \u003E 10 =\u003E Ordinal\n\n\u003E Warning : it depend nature of the feature, be carefull\n\"\"\")", "code_hash": "a3c4bc5928068d5b0bc41ab94c8f2ca5", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "bkHC", "name": "_"}, {"code": "pf.select(pl.all().n_unique())", "code_hash": "ff0ca13a14b440de22761ad91810abaa", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}, {"code": "mo.md(r\"\"\"\n# Preprocessing\n* Casting : to define best type feature\n* Encoders : Onehot, Ordinal\n* Scalers : MinMax, MaxAbs, Robust, Standard\n* Drop non numerical features\n\"\"\")", "code_hash": "6d1994144452986b86fd5f3c8fa2c172", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "PKri", "name": "_"}, {"code": "def logshow(func):\n    \"\"\"\n        decorator for function transformation\n        using wraps decorator to get args and kwargs from function\n        out is displaying function name, dataframe shape, columns name and dtypes\n    \"\"\"\n    @wraps(func)\n    def wrapper(*args,**kwargs):\n\n        ret = func(*args,**kwargs)\n        print(func.__name__,ret.shape,dict(zip(ret.columns,ret.dtypes)))\n        return ret\n    return wrapper\n\n\n@logshow\ndef casting(_df:pl.DataFrame)-\u003Epl.DataFrame:\n    \"\"\"\n        Features typing\n        Parameters : _df = DataFrame polars\n        Returns : DataFrame polars with correct type \n    \"\"\"\n    return(_df\n        .cast({'passengers':pl.Int8})\n        .with_columns(\n            pl.col(['distance','fare','tip','tolls','total']).cast(pl.Float64),\n            pl.col(['pickup','dropoff']).str.slice(0,23).str.strptime(pl.Datetime(time_unit='ms'),\"%Y-%m-%d %H:%M:%S.%3f\")\n        )   \n    )\n\n@logshow\ndef select_by_nunique(_df:pl.DataFrame,_condition:str,_threshold:int)-\u003Epl.DataFrame:\n    \"\"\"\n        Selection columns names diffrent condition threshold\n        Parameters : _df = DataFrame polars, _threshold = nunique value\n        Returns : DataFrame polars with correct type \n    \"\"\"\n    match _condition:\n        case '\u003C':\n            return(_df.select(_df.select(pl.all().n_unique()).unpivot(index=None,on=_df.columns).filter(pl.col('value') \u003C _threshold).to_series(0).to_list()))\n        case '\u003C=':\n            return(_df.select(_df.select(pl.all().n_unique()).unpivot(index=None,on=_df.columns).filter(pl.col('value') \u003C= _threshold).to_series(0).to_list()))\n        case '\u003E':\n            return(_df.select(_df.select(pl.all().n_unique()).unpivot(index=None,on=_df.columns).filter(pl.col('value') \u003E _threshold).to_series(0).to_list()))\n        case '\u003E=':\n            return(_df.select(_df.select(pl.all().n_unique()).unpivot(index=None,on=_df.columns).filter(pl.col('value') \u003E= _threshold).to_series(0).to_list()))\n        case '=':\n            return(_df.select(_df.select(pl.all().n_unique()).unpivot(index=None,on=_df.columns).filter(pl.col('value') == _threshold).to_series(0).to_list()))\n\n@logshow    \ndef exclude_by_dtypes_cols(_df:pl.DataFrame,_dtypes:list[pl.DataType])-\u003Epl.DataFrame:\n    \"\"\"\n        Exclude columns by dtypes\n        Parameters : _df = polars DataFrame, _dtypes = list polars DataType\n        Returns : DataFrame polars without ecluded columns\n    \"\"\"\n    return(_df\n              .select(pl.all().exclude(_dtypes))\n          )\n\n### ENCODERS\n\n@logshow\ndef ordinal_encoder(_df:pl.DataFrame,_to_encode:str)-\u003Epl.DataFrame:\n    \"\"\"\n        Basic encoder based from position unique values (row index)\n        Parameters : _df = DataFrame polars, _to_encode = name of feature\n        Returns : polars DataFrame with new colomn ordinal\n    \"\"\"\n    return(_df\n            .join(_df\n                .select(pl.col(_to_encode).unique(maintain_order=True))\n                .with_row_index(name=_to_encode+'_ordinal')\n            , on=_to_encode)\n    )\n\n@logshow\ndef value_count_encoder(_df:pl.DataFrame,_to_encode:str,_descending:bool=True,_start:int=1)-\u003Epl.DataFrame:\n    '''\n        Based encoder from value_counts, the greatest have the biggest value\n        Parameters : _df = DataFrame polars, _to_encode = name of feature, _descending = Smallest first (True) and Greatest first (False), _start = start ordering from 1 or other int\n        Returns : polars DataFrame with new colomn ordinal\n    '''\n    return(_df\n           .join(_df\n                 .select(pl.col(_to_encode).value_counts()).unnest(_to_encode)\n                    .sort(by='count',descending=_descending)\n                    .with_row_index(offset=_start,name=_to_encode+'_vc_ordinal')\n                 , on = _to_encode)\n           .drop('count')\n    )\n\n\n\n@logshow\ndef onehot_encoder(_df:pl.DataFrame,_to_encode:str,_dropfirst:bool=True)-\u003Epl.DataFrame:\n    '''\n        Encode each class from the feature with value 0 or 1\n        Parameters : _df = DataFrame polars, _to_encode = name of feature, _dropfitst = remove 1 class to reduce bias    \n        Returns : polars DataFrame with several columns for each class  \n    '''\n    return(_df\n            .with_row_index()\n            .join(_df.select(pl.col(_to_encode)).to_dummies(drop_first=_dropfirst).with_row_index(),on = 'index')\n            .drop('index')\n          )\n\n### SCALERS \n\nNUMERICS_DTYPES = pl.selectors.by_dtype([pl.Float16,pl.Float32,pl.Float64])\n\n@logshow\ndef standard_scaler(_df:pl.DataFrame,_col:str)-\u003Epl.DataFrame:\n    \"\"\"\n        Standard Scaler X - mean / std\n        Parameters : _df = polars DataFrame, _col = feature name frome a mesure\n        Returns : DataFrame polars with new _standard column\n    \"\"\"\n\n    return(_df\n              .with_columns(\n                  pl.col(_col)\n                    .map_batches(lambda x: (x -x.mean())/x.std(ddof=1),return_dtype=pl.Float64)\n                    .alias(_col+'_standard')\n              )\n          )\n\n\n\n@logshow\ndef minmax_scaler(_df:pl.DataFrame,_col:str)-\u003Epl.DataFrame:\n    \"\"\"\n        Min Max Scaler X - min / max - min\n        Parameters : _df = polars DataFrame, _col = feature name frome a mesure\n        Returns : DataFrame polars with new _minmax column\n    \"\"\"\n    return(_df\n              .with_columns(\n                  pl.col(_col)\n                    .map_batches(lambda x: (x - x.min())/(x.max()-x.min()),return_dtype=pl.Float64)\n                  .alias(_col+'_minmax')\n              )\n          )\n\n@logshow\ndef maxabs_scaler(_df:pl.DataFrame,_col:str)-\u003Epl.DataFrame:\n    \"\"\"\n        Max abs Scaler X / max absolute\n        Parameters : _df = polars DataFrame, _col = feature name frome a mesure\n        Returns : DataFrame polars with new _maxabs column\n    \"\"\"\n    return(_df\n              .with_columns(\n                  pl.col(_col)\n                    .map_batches(lambda x: (x/x.abs().max()),return_dtype=pl.Float64)\n                    .alias(_col+'_maxabs')\n              )\n          )\n\n\n@logshow\ndef robust_scaler(_df:pl.DataFrame,_col:str)-\u003Epl.DataFrame:\n    \"\"\"\n        Robust Scaler X - median / q3 - q1\n        Parameters : _df = polars DataFrame, _col = feature name frome a mesure\n        Returns : DataFrame polars with new _robust column\n    \"\"\"\n    return(_df\n             .with_columns(\n                  pl.col(_col).map_batches(lambda x: (x-x.median())/(x.quantile(.75)-x.quantile(.25)),return_dtype=pl.Float64)\n                    .alias(_col+'_robust')\n             )\n          )", "code_hash": "a1a73c2a9575412ad71bf91ba5122848", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Piepline\n\"\"\")", "code_hash": "e85cd113741e365c5083984d61959698", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "SFPL", "name": "_"}, {"code": "\n(pf\n    .pipe(casting)\n    .pipe(onehot_encoder,'color')\n    .pipe(onehot_encoder,'payment')\n    .pipe(value_count_encoder,'pickup_borough')\n    .pipe(standard_scaler,'distance')\n    .pipe(standard_scaler,'fare')\n    .pipe(exclude_by_dtypes_cols,[pl.Datetime,pl.String]) \n    #.describe()\n )", "code_hash": "b3d5a0b40efde34ba83701cba7c87574", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "_"}, {"code": "mo.md(r\"\"\"\n# Checking preprocessing with Scklearn\n\"\"\")", "code_hash": "3e52e4621d57337574b1d1be4bdb1e84", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "RGSE", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Ordinal Encoder\n\"\"\")", "code_hash": "e7ece1b36740065fcf48ab54566018fa", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Kclp", "name": "_"}, {"code": "ordinal_enc = OrdinalEncoder()\n(pl.DataFrame(ordinal_enc.fit_transform(pf.pipe(casting).pipe(exclude_by_dtypes_cols,[pl.Int8,pl.Datetime,pl.Float64]).pipe(select_by_nunique,'\u003E',10)),\n              schema=list(ordinal_enc.get_feature_names_out()),\n              orient='row')\n    .describe()\n)", "code_hash": "307ed5262c9cc807364af4b160e48bfc", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "emfo", "name": "_"}, {"code": "mo.md(r\"\"\"\n## OneHot Encoder\n\"\"\")", "code_hash": "e6de36cb2eeedfee1ed6f8df231d7e65", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Hstk", "name": "_"}, {"code": "onehot_enc = OneHotEncoder(drop='first',sparse_output=False)\n\n\n(pl.DataFrame(onehot_enc.fit_transform(pf.pipe(casting).pipe(exclude_by_dtypes_cols,[pl.Int8]).pipe(select_by_nunique,'\u003C',10)),\n              schema=list(onehot_enc.get_feature_names_out()),\n              orient='row')\n    .describe()\n)", "code_hash": "530f75c2484ae38e75ebb99be999a9cc", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nWHF", "name": "_"}, {"code": "mo.md(r\"\"\"\n## StandardScaler\n\"\"\")", "code_hash": "d17eaf801bdacabc939fcdcc6b15a85e", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "iLit", "name": "_"}, {"code": "sk_std_scaler = StandardScaler()\n(pl.DataFrame(data=sk_std_scaler.fit_transform(pf.pipe(casting).select([NUMERICS_DTYPES])),\n             schema=list(sk_std_scaler.get_feature_names_out()),\n             orient='row')\n    .describe()\n)", "code_hash": "3bcaad85e4ab1e1c3e93dc3ad28e4eb3", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZHCJ", "name": "_"}, {"code": "mo.md(r\"\"\"\n## MinMaxScaler\n\"\"\")", "code_hash": "9d12b5c1cf0b6bd4f612c0bda14f7705", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ROlb", "name": "_"}, {"code": "sk_minmax_scaler = MinMaxScaler()\n(pl.DataFrame(data=sk_minmax_scaler.fit_transform(pf.pipe(casting).select([NUMERICS_DTYPES])),\n             schema=list(sk_minmax_scaler.get_feature_names_out()),\n             orient='row')\n    .describe()\n)", "code_hash": "9d8c1e089edd916162a0e190885d52b6", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "qnkX", "name": "_"}, {"code": "mo.md(r\"\"\"\n## RobustScaler\n\"\"\")", "code_hash": "a4f355fdd06e8955809e23ff463a7ffe", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "TqIu", "name": "_"}, {"code": "sk_robust_scaler = RobustScaler()\n(pl.DataFrame(data=sk_robust_scaler.fit_transform(pf.pipe(casting).select([NUMERICS_DTYPES])),\n             schema=list(sk_robust_scaler.get_feature_names_out()),\n             orient='row')\n    .describe()\n)", "code_hash": "de0af6811962af361cb69abe4b5b2730", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Vxnm", "name": "_"}, {"code": "mo.md(r\"\"\"\n## MaxAbs Scaler\n\"\"\")", "code_hash": "6fa9f6d6c75dd445308cd400baa4cc5a", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "DnEU", "name": "_"}, {"code": "sk_maxabs_scaler = MaxAbsScaler()\n(pl.DataFrame(data=sk_maxabs_scaler.fit_transform(pf.pipe(casting).select([NUMERICS_DTYPES])),\n             schema=list(sk_maxabs_scaler.get_feature_names_out()),\n             orient='row')\n    .describe()\n)", "code_hash": "12f79163e4e1f59afe142eddfa60d225", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ulZA", "name": "_"}, {"code": "mo.md(r\"\"\"\n# Conclusion\n\n* Actually with this code it's better to use Scikit-Learn preprocessing\n* Probably in feature, i will find another way to be faster with Polars\n\"\"\")", "code_hash": "68574d0a14ec4b4dd53438426781aa1f", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ecfG", "name": "_"}], "metadata": {"marimo_version": "0.18.4"}, "version": "1"},
            "session": {"cells": [{"code_hash": "626d46b932cfca07000eaeae14da8b22", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "426ddfdb43e6e5fb9e91424ee2083b02", "console": [], "id": "MJUe", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"loading-dataset\"\u003ELoading DataSet\u003C/h1\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "399e45a1ce8f8282113e7ef0537e2c89", "console": [], "id": "vblA", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='vblA-0' random-id='0ce8bc9f-0419-ec17-3f05-a3e95d3e8a2d'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='\u0026quot;[{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;count\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup\u0026#92;\u0026quot;:\u0026#92;\u0026quot;6433\u0026#92;\u0026quot;,\u0026#92;\u0026quot;dropoff\u0026#92;\u0026quot;:\u0026#92;\u0026quot;6433\u0026#92;\u0026quot;,\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:\u0026#92;\u0026quot;6433\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:\u0026#92;\u0026quot;6433\u0026#92;\u0026quot;,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:\u0026#92;\u0026quot;6433\u0026#92;\u0026quot;,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:\u0026#92;\u0026quot;6433\u0026#92;\u0026quot;,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:\u0026#92;\u0026quot;6433\u0026#92;\u0026quot;,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:\u0026#92;\u0026quot;6433\u0026#92;\u0026quot;,\u0026#92;\u0026quot;color\u0026#92;\u0026quot;:\u0026#92;\u0026quot;6433\u0026#92;\u0026quot;,\u0026#92;\u0026quot;payment\u0026#92;\u0026quot;:\u0026#92;\u0026quot;6389\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup_zone\u0026#92;\u0026quot;:\u0026#92;\u0026quot;6407\u0026#92;\u0026quot;,\u0026#92;\u0026quot;dropoff_zone\u0026#92;\u0026quot;:\u0026#92;\u0026quot;6388\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup_borough\u0026#92;\u0026quot;:\u0026#92;\u0026quot;6407\u0026#92;\u0026quot;,\u0026#92;\u0026quot;dropoff_borough\u0026#92;\u0026quot;:\u0026#92;\u0026quot;6388\u0026#92;\u0026quot;},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;null_count\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup\u0026#92;\u0026quot;:\u0026#92;\u0026quot;0\u0026#92;\u0026quot;,\u0026#92;\u0026quot;dropoff\u0026#92;\u0026quot;:\u0026#92;\u0026quot;0\u0026#92;\u0026quot;,\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:\u0026#92;\u0026quot;0\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:\u0026#92;\u0026quot;0\u0026#92;\u0026quot;,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:\u0026#92;\u0026quot;0\u0026#92;\u0026quot;,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:\u0026#92;\u0026quot;0\u0026#92;\u0026quot;,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:\u0026#92;\u0026quot;0\u0026#92;\u0026quot;,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:\u0026#92;\u0026quot;0\u0026#92;\u0026quot;,\u0026#92;\u0026quot;color\u0026#92;\u0026quot;:\u0026#92;\u0026quot;0\u0026#92;\u0026quot;,\u0026#92;\u0026quot;payment\u0026#92;\u0026quot;:\u0026#92;\u0026quot;44\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup_zone\u0026#92;\u0026quot;:\u0026#92;\u0026quot;26\u0026#92;\u0026quot;,\u0026#92;\u0026quot;dropoff_zone\u0026#92;\u0026quot;:\u0026#92;\u0026quot;45\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup_borough\u0026#92;\u0026quot;:\u0026#92;\u0026quot;26\u0026#92;\u0026quot;,\u0026#92;\u0026quot;dropoff_borough\u0026#92;\u0026quot;:\u0026#92;\u0026quot;45\u0026#92;\u0026quot;},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;mean\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;dropoff\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;color\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;payment\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;pickup_zone\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;dropoff_zone\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;pickup_borough\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;dropoff_borough\u0026#92;\u0026quot;:null},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;std\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;dropoff\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;color\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;payment\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;pickup_zone\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;dropoff_zone\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;pickup_borough\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;dropoff_borough\u0026#92;\u0026quot;:null},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;min\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2019-02-28 23:29:03.000000000\u0026#92;\u0026quot;,\u0026#92;\u0026quot;dropoff\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2019-02-28 23:32:35.000000000\u0026#92;\u0026quot;,\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:\u0026#92;\u0026quot;0\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:\u0026#92;\u0026quot;0.0\u0026#92;\u0026quot;,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:\u0026#92;\u0026quot;1.0\u0026#92;\u0026quot;,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:\u0026#92;\u0026quot;0.0\u0026#92;\u0026quot;,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:\u0026#92;\u0026quot;0.0\u0026#92;\u0026quot;,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:\u0026#92;\u0026quot;1.3\u0026#92;\u0026quot;,\u0026#92;\u0026quot;color\u0026#92;\u0026quot;:\u0026#92;\u0026quot;green\u0026#92;\u0026quot;,\u0026#92;\u0026quot;payment\u0026#92;\u0026quot;:\u0026#92;\u0026quot;cash\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup_zone\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Allerton/Pelham Gardens\u0026#92;\u0026quot;,\u0026#92;\u0026quot;dropoff_zone\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Allerton/Pelham Gardens\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup_borough\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Bronx\u0026#92;\u0026quot;,\u0026#92;\u0026quot;dropoff_borough\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Bronx\u0026#92;\u0026quot;},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;25%\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;dropoff\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;color\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;payment\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;pickup_zone\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;dropoff_zone\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;pickup_borough\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;dropoff_borough\u0026#92;\u0026quot;:null},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;50%\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;dropoff\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;color\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;payment\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;pickup_zone\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;dropoff_zone\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;pickup_borough\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;dropoff_borough\u0026#92;\u0026quot;:null},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;75%\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;dropoff\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;color\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;payment\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;pickup_zone\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;dropoff_zone\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;pickup_borough\u0026#92;\u0026quot;:null,\u0026#92;\u0026quot;dropoff_borough\u0026#92;\u0026quot;:null},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;max\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2019-03-31 23:43:45.000000000\u0026#92;\u0026quot;,\u0026#92;\u0026quot;dropoff\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2019-04-01 00:13:58.000000000\u0026#92;\u0026quot;,\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:\u0026#92;\u0026quot;6\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:\u0026#92;\u0026quot;9.99\u0026#92;\u0026quot;,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:\u0026#92;\u0026quot;96.5\u0026#92;\u0026quot;,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:\u0026#92;\u0026quot;9.95\u0026#92;\u0026quot;,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:\u0026#92;\u0026quot;9.5\u0026#92;\u0026quot;,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:\u0026#92;\u0026quot;94.8\u0026#92;\u0026quot;,\u0026#92;\u0026quot;color\u0026#92;\u0026quot;:\u0026#92;\u0026quot;yellow\u0026#92;\u0026quot;,\u0026#92;\u0026quot;payment\u0026#92;\u0026quot;:\u0026#92;\u0026quot;credit card\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup_zone\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Yorkville West\u0026#92;\u0026quot;,\u0026#92;\u0026quot;dropoff_zone\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Yorkville West\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup_borough\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Queens\u0026#92;\u0026quot;,\u0026#92;\u0026quot;dropoff_borough\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Staten Island\u0026#92;\u0026quot;}]\u0026quot;' data-total-rows='9' data-total-columns='15' data-max-columns='50' data-banner-text='\u0026quot;\u0026quot;' data-pagination='true' data-page-size='30' data-field-types='[[\u0026quot;statistic\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;pickup\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;dropoff\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;passengers\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;distance\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;fare\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;tip\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;tolls\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;total\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;color\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;payment\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;pickup_zone\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;dropoff_zone\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;pickup_borough\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;dropoff_borough\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "a3c4bc5928068d5b0bc41ab94c8f2ca5", "console": [], "id": "bkHC", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"detect-which-encoder-ordinal-or-onehot\"\u003EDetect which encoder Ordinal or OneHot\u003C/h2\u003E\n\u003Cul\u003E\n\u003Cli\u003ETry feature.n_unique \u0026lt; 10 =\u0026gt; OneHot\u003C/li\u003E\n\u003Cli\u003ETry feature.n_unique \u0026gt; 10 =\u0026gt; Ordinal\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cblockquote\u003E\n\u003Cspan class=\"paragraph\"\u003EWarning : it depend nature of the feature, be carefull\u003C/span\u003E\n\u003C/blockquote\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "ff0ca13a14b440de22761ad91810abaa", "console": [], "id": "lEQa", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='lEQa-0' random-id='167cf59f-3976-1cc7-1962-7deaff1d4f50'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='\u0026quot;[{\u0026#92;\u0026quot;pickup\u0026#92;\u0026quot;:6414,\u0026#92;\u0026quot;dropoff\u0026#92;\u0026quot;:6425,\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:7,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:1079,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:220,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:489,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:16,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:898,\u0026#92;\u0026quot;color\u0026#92;\u0026quot;:2,\u0026#92;\u0026quot;payment\u0026#92;\u0026quot;:3,\u0026#92;\u0026quot;pickup_zone\u0026#92;\u0026quot;:195,\u0026#92;\u0026quot;dropoff_zone\u0026#92;\u0026quot;:204,\u0026#92;\u0026quot;pickup_borough\u0026#92;\u0026quot;:5,\u0026#92;\u0026quot;dropoff_borough\u0026#92;\u0026quot;:6}]\u0026quot;' data-total-rows='1' data-total-columns='14' data-max-columns='50' data-banner-text='\u0026quot;\u0026quot;' data-pagination='true' data-page-size='30' data-field-types='[[\u0026quot;pickup\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;u32\u0026quot;]],[\u0026quot;dropoff\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;u32\u0026quot;]],[\u0026quot;passengers\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;u32\u0026quot;]],[\u0026quot;distance\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;u32\u0026quot;]],[\u0026quot;fare\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;u32\u0026quot;]],[\u0026quot;tip\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;u32\u0026quot;]],[\u0026quot;tolls\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;u32\u0026quot;]],[\u0026quot;total\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;u32\u0026quot;]],[\u0026quot;color\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;u32\u0026quot;]],[\u0026quot;payment\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;u32\u0026quot;]],[\u0026quot;pickup_zone\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;u32\u0026quot;]],[\u0026quot;dropoff_zone\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;u32\u0026quot;]],[\u0026quot;pickup_borough\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;u32\u0026quot;]],[\u0026quot;dropoff_borough\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;u32\u0026quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "6d1994144452986b86fd5f3c8fa2c172", "console": [], "id": "PKri", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"preprocessing\"\u003EPreprocessing\u003C/h1\u003E\n\u003Cul\u003E\n\u003Cli\u003ECasting : to define best type feature\u003C/li\u003E\n\u003Cli\u003EEncoders : Onehot, Ordinal\u003C/li\u003E\n\u003Cli\u003EScalers : MinMax, MaxAbs, Robust, Standard\u003C/li\u003E\n\u003Cli\u003EDrop non numerical features\u003C/li\u003E\n\u003C/ul\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "a1a73c2a9575412ad71bf91ba5122848", "console": [], "id": "Xref", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "e85cd113741e365c5083984d61959698", "console": [], "id": "SFPL", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"piepline\"\u003EPiepline\u003C/h2\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "b3d5a0b40efde34ba83701cba7c87574", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "casting (6433, 14) {'pickup': Datetime(time_unit='ms', time_zone=None), 'dropoff': Datetime(time_unit='ms', time_zone=None), 'passengers': Int8, 'distance': Float64, 'fare': Float64, 'tip': Float64, 'tolls': Float64, 'total': Float64, 'color': String, 'payment': String, 'pickup_zone': String, 'dropoff_zone': String, 'pickup_borough': String, 'dropoff_borough': String}\nonehot_encoder (6433, 15) {'pickup': Datetime(time_unit='ms', time_zone=None), 'dropoff': Datetime(time_unit='ms', time_zone=None), 'passengers': Int8, 'distance': Float64, 'fare': Float64, 'tip': Float64, 'tolls': Float64, 'total': Float64, 'color': String, 'payment': String, 'pickup_zone': String, 'dropoff_zone': String, 'pickup_borough': String, 'dropoff_borough': String, 'color_green': UInt8}\nonehot_encoder (6433, 17) {'pickup': Datetime(time_unit='ms', time_zone=None), 'dropoff': Datetime(time_unit='ms', time_zone=None), 'passengers': Int8, 'distance': Float64, 'fare': Float64, 'tip': Float64, 'tolls': Float64, 'total': Float64, 'color': String, 'payment': String, 'pickup_zone': String, 'dropoff_zone': String, 'pickup_borough': String, 'dropoff_borough': String, 'color_green': UInt8, 'payment_cash': UInt8, 'payment_null': UInt8}\nvalue_count_encoder (6407, 18) {'pickup': Datetime(time_unit='ms', time_zone=None), 'dropoff': Datetime(time_unit='ms', time_zone=None), 'passengers': Int8, 'distance': Float64, 'fare': Float64, 'tip': Float64, 'tolls': Float64, 'total': Float64, 'color': String, 'payment': String, 'pickup_zone': String, 'dropoff_zone': String, 'pickup_borough': String, 'dropoff_borough': String, 'color_green': UInt8, 'payment_cash': UInt8, 'payment_null': UInt8, 'pickup_borough_vc_ordinal': UInt32}\nstandard_scaler (6407, 19) {'pickup': Datetime(time_unit='ms', time_zone=None), 'dropoff': Datetime(time_unit='ms', time_zone=None), 'passengers': Int8, 'distance': Float64, 'fare': Float64, 'tip': Float64, 'tolls': Float64, 'total': Float64, 'color': String, 'payment': String, 'pickup_zone': String, 'dropoff_zone': String, 'pickup_borough': String, 'dropoff_borough': String, 'color_green': UInt8, 'payment_cash': UInt8, 'payment_null': UInt8, 'pickup_borough_vc_ordinal': UInt32, 'distance_standard': Float64}\nstandard_scaler (6407, 20) {'pickup': Datetime(time_unit='ms', time_zone=None), 'dropoff': Datetime(time_unit='ms', time_zone=None), 'passengers': Int8, 'distance': Float64, 'fare': Float64, 'tip': Float64, 'tolls': Float64, 'total': Float64, 'color': String, 'payment': String, 'pickup_zone': String, 'dropoff_zone': String, 'pickup_borough': String, 'dropoff_borough': String, 'color_green': UInt8, 'payment_cash': UInt8, 'payment_null': UInt8, 'pickup_borough_vc_ordinal': UInt32, 'distance_standard': Float64, 'fare_standard': Float64}\nexclude_by_dtypes_cols (6407, 12) {'passengers': Int8, 'distance': Float64, 'fare': Float64, 'tip': Float64, 'tolls': Float64, 'total': Float64, 'color_green': UInt8, 'payment_cash': UInt8, 'payment_null': UInt8, 'pickup_borough_vc_ordinal': UInt32, 'distance_standard': Float64, 'fare_standard': Float64}\n", "type": "stream"}], "id": "BYtC", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='BYtC-0' random-id='c143ea86-dbf6-dea8-02a0-ecf47407749a'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='\u0026quot;[{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:1.6,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:7.0,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:2.15,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:12.95,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:-0.3734288956948807,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:-0.5314060474242368},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.79,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:5.0,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:9.3,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:-0.5851477467074805,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:-0.7073929176588348},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:1.37,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:7.5,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:2.36,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:14.16,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:-0.4335465941305572,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:-0.48740932986558727},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:7.7,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:27.0,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:6.15,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:36.95,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:1.2209970193382782,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:1.2284626549217434},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:3,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:2.16,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:9.0,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:1.1,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:13.4,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:-0.2270553690688858,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:-0.3554191771896388},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.49,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:7.5,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:2.16,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:12.96,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:-0.6635621359714063,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:-0.48740932986558727},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:3.65,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:13.0,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:2.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:18.8,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:0.1624027642752792,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:-0.003445436720442711},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:1.4,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:8.5,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:11.8,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:-0.42570515520416463,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:-0.39941589474828826},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:3.63,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:15.0,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:19.3,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:0.1571751383243508,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:0.17254143351415532},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:1.52,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:8.0,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:13.3,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:-0.39433939949859426,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:-0.4434126123069378},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:3.9,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:17.0,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:17.8,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:2,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:0.22774808866188406,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:0.3485283037487533},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:1.53,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:6.5,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:2.16,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:12.96,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:-0.39172558652313005,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:-0.5754027649828863},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:1.05,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:6.5,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:11.3,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:-0.5171886093454114,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:-0.5754027649828863},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:1.75,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:10.5,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:13.8,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:-0.3342217010629178,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:-0.22342902451369023},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:2.9,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:11.5,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:14.8,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:-0.03363320888453543,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:-0.13543558939639122},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:3,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:2.09,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:13.5,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:16.8,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:-0.2453520598971352,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:0.0405512808382068},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:2.12,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:13.0,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:16.3,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:-0.23751062097074258,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:-0.003445436720442711},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:2.6,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:10.5,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:2.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:16.3,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:-0.11204759814846123,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:-0.22342902451369023},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:2.18,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:9.5,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:1.92,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:14.72,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:-0.2218277431179574,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:-0.31142245963098925},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:1.08,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:6.5,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:1.08,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:11.38,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:-0.5093471704190188,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:-0.5754027649828863},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:1.07,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:6.5,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:1.54,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:11.84,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:-0.511960983394483,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:-0.5754027649828863},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.8,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:5.5,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:2.3,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:11.6,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:-0.5825339337320163,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:-0.6633962001001853},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:9.82,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:31.5,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:8.31,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:5.76,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:49.87,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:2,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:1.7751253701366874,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:1.6244331129495893},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:5,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:1.09,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:8.5,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:2.36,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:14.16,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:-0.5067333574435546,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:-0.39941589474828826},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:5,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:2.89,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:9.5,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:3.84,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:16.64,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:-0.03624702185999957,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:-0.31142245963098925},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:1.9,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:10.0,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:3.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:16.3,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:-0.2950145064309549,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:-0.26742574207233977},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:3.35,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:13.5,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:17.3,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:0.08398837501135338,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:0.0405512808382068},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:2.6,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:12.5,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:3.26,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:19.56,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:-0.11204759814846123,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:-0.047442154279092215},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:4.71,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:17.5,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:18.3,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:0.43946693967448386,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:0.39252502130740285},{\u0026#92;\u0026quot;passengers\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.92,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:12.0,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:15.3,\u0026#92;\u0026quot;color_green\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;payment_cash\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;payment_null\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;pickup_borough_vc_ordinal\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;distance_standard\u0026#92;\u0026quot;:-0.551168178026446,\u0026#92;\u0026quot;fare_standard\u0026#92;\u0026quot;:-0.09143887183774173}]\u0026quot;' data-total-rows='6407' data-total-columns='12' data-max-columns='50' data-banner-text='\u0026quot;\u0026quot;' data-pagination='true' data-page-size='30' data-field-types='[[\u0026quot;passengers\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;i8\u0026quot;]],[\u0026quot;distance\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;fare\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;tip\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;tolls\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;total\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;color_green\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;u8\u0026quot;]],[\u0026quot;payment_cash\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;u8\u0026quot;]],[\u0026quot;payment_null\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;u8\u0026quot;]],[\u0026quot;pickup_borough_vc_ordinal\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;u32\u0026quot;]],[\u0026quot;distance_standard\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;fare_standard\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='true' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "3e52e4621d57337574b1d1be4bdb1e84", "console": [], "id": "RGSE", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"checking-preprocessing-with-scklearn\"\u003EChecking preprocessing with Scklearn\u003C/h1\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "e7ece1b36740065fcf48ab54566018fa", "console": [], "id": "Kclp", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"ordinal-encoder\"\u003EOrdinal Encoder\u003C/h2\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "307ed5262c9cc807364af4b160e48bfc", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "casting (6433, 14) {'pickup': Datetime(time_unit='ms', time_zone=None), 'dropoff': Datetime(time_unit='ms', time_zone=None), 'passengers': Int8, 'distance': Float64, 'fare': Float64, 'tip': Float64, 'tolls': Float64, 'total': Float64, 'color': String, 'payment': String, 'pickup_zone': String, 'dropoff_zone': String, 'pickup_borough': String, 'dropoff_borough': String}\nexclude_by_dtypes_cols (6433, 6) {'color': String, 'payment': String, 'pickup_zone': String, 'dropoff_zone': String, 'pickup_borough': String, 'dropoff_borough': String}\nselect_by_nunique (6433, 2) {'pickup_zone': String, 'dropoff_zone': String}\n", "type": "stream"}], "id": "emfo", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='emfo-0' random-id='29e0d0a1-991a-921b-5ffd-bd9524dbec77'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='\u0026quot;[{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;count\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup_zone\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;dropoff_zone\u0026#92;\u0026quot;:6433.0},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;null_count\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup_zone\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_zone\u0026#92;\u0026quot;:0.0},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;mean\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup_zone\u0026#92;\u0026quot;:109.9365770247163,\u0026#92;\u0026quot;dropoff_zone\u0026#92;\u0026quot;:115.2538473496036},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;std\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup_zone\u0026#92;\u0026quot;:51.32586625233481,\u0026#92;\u0026quot;dropoff_zone\u0026#92;\u0026quot;:55.25294963434734},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;min\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup_zone\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_zone\u0026#92;\u0026quot;:0.0},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;25%\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup_zone\u0026#92;\u0026quot;:71.0,\u0026#92;\u0026quot;dropoff_zone\u0026#92;\u0026quot;:72.0},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;50%\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup_zone\u0026#92;\u0026quot;:113.0,\u0026#92;\u0026quot;dropoff_zone\u0026#92;\u0026quot;:119.0},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;75%\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup_zone\u0026#92;\u0026quot;:165.0,\u0026#92;\u0026quot;dropoff_zone\u0026#92;\u0026quot;:174.0},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;max\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pickup_zone\u0026#92;\u0026quot;:194.0,\u0026#92;\u0026quot;dropoff_zone\u0026#92;\u0026quot;:203.0}]\u0026quot;' data-total-rows='9' data-total-columns='3' data-max-columns='50' data-banner-text='\u0026quot;\u0026quot;' data-pagination='true' data-page-size='30' data-field-types='[[\u0026quot;statistic\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;pickup_zone\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;dropoff_zone\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "e6de36cb2eeedfee1ed6f8df231d7e65", "console": [], "id": "Hstk", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"onehot-encoder\"\u003EOneHot Encoder\u003C/h2\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "530f75c2484ae38e75ebb99be999a9cc", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "casting (6433, 14) {'pickup': Datetime(time_unit='ms', time_zone=None), 'dropoff': Datetime(time_unit='ms', time_zone=None), 'passengers': Int8, 'distance': Float64, 'fare': Float64, 'tip': Float64, 'tolls': Float64, 'total': Float64, 'color': String, 'payment': String, 'pickup_zone': String, 'dropoff_zone': String, 'pickup_borough': String, 'dropoff_borough': String}\nexclude_by_dtypes_cols (6433, 13) {'pickup': Datetime(time_unit='ms', time_zone=None), 'dropoff': Datetime(time_unit='ms', time_zone=None), 'distance': Float64, 'fare': Float64, 'tip': Float64, 'tolls': Float64, 'total': Float64, 'color': String, 'payment': String, 'pickup_zone': String, 'dropoff_zone': String, 'pickup_borough': String, 'dropoff_borough': String}\nselect_by_nunique (6433, 4) {'color': String, 'payment': String, 'pickup_borough': String, 'dropoff_borough': String}\n", "type": "stream"}], "id": "nWHF", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='nWHF-0' random-id='bed6ca1a-f09a-6837-9739-4a007dd698ee'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='\u0026quot;[{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;count\u0026#92;\u0026quot;,\u0026#92;\u0026quot;color_yellow\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;payment_credit card\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;payment_None\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;pickup_borough_Brooklyn\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;pickup_borough_Manhattan\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;pickup_borough_Queens\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;pickup_borough_None\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;dropoff_borough_Brooklyn\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;dropoff_borough_Manhattan\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;dropoff_borough_Queens\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;dropoff_borough_Staten Island\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;dropoff_borough_None\u0026#92;\u0026quot;:6433.0},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;null_count\u0026#92;\u0026quot;,\u0026#92;\u0026quot;color_yellow\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;payment_credit card\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;payment_None\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;pickup_borough_Brooklyn\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;pickup_borough_Manhattan\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;pickup_borough_Queens\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;pickup_borough_None\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_borough_Brooklyn\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_borough_Manhattan\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_borough_Queens\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_borough_Staten Island\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_borough_None\u0026#92;\u0026quot;:0.0},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;mean\u0026#92;\u0026quot;,\u0026#92;\u0026quot;color_yellow\u0026#92;\u0026quot;:0.8473496036064044,\u0026#92;\u0026quot;payment_credit card\u0026#92;\u0026quot;:0.7114876418467279,\u0026#92;\u0026quot;payment_None\u0026#92;\u0026quot;:0.006839732628633608,\u0026#92;\u0026quot;pickup_borough_Brooklyn\u0026#92;\u0026quot;:0.0595367635628789,\u0026#92;\u0026quot;pickup_borough_Manhattan\u0026#92;\u0026quot;:0.818902533810042,\u0026#92;\u0026quot;pickup_borough_Queens\u0026#92;\u0026quot;:0.10212964402300638,\u0026#92;\u0026quot;pickup_borough_None\u0026#92;\u0026quot;:0.004041660189647132,\u0026#92;\u0026quot;dropoff_borough_Brooklyn\u0026#92;\u0026quot;:0.07787968288512358,\u0026#92;\u0026quot;dropoff_borough_Manhattan\u0026#92;\u0026quot;:0.8092647287424218,\u0026#92;\u0026quot;dropoff_borough_Queens\u0026#92;\u0026quot;:0.08425307010725944,\u0026#92;\u0026quot;dropoff_borough_Staten Island\u0026#92;\u0026quot;:0.000310896937665164,\u0026#92;\u0026quot;dropoff_borough_None\u0026#92;\u0026quot;:0.00699518109746619},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;std\u0026#92;\u0026quot;,\u0026#92;\u0026quot;color_yellow\u0026#92;\u0026quot;:0.35967813804624776,\u0026#92;\u0026quot;payment_credit card\u0026#92;\u0026quot;:0.4531058283416416,\u0026#92;\u0026quot;payment_None\u0026#92;\u0026quot;:0.08242576541444645,\u0026#92;\u0026quot;pickup_borough_Brooklyn\u0026#92;\u0026quot;:0.23664497161902914,\u0026#92;\u0026quot;pickup_borough_Manhattan\u0026#92;\u0026quot;:0.38512884948298637,\u0026#92;\u0026quot;pickup_borough_Queens\u0026#92;\u0026quot;:0.3028422634772484,\u0026#92;\u0026quot;pickup_borough_None\u0026#92;\u0026quot;:0.06345038219331048,\u0026#92;\u0026quot;dropoff_borough_Brooklyn\u0026#92;\u0026quot;:0.2680029907647574,\u0026#92;\u0026quot;dropoff_borough_Manhattan\u0026#92;\u0026quot;:0.3929113457074737,\u0026#92;\u0026quot;dropoff_borough_Queens\u0026#92;\u0026quot;:0.27778856293376697,\u0026#92;\u0026quot;dropoff_borough_Staten Island\u0026#92;\u0026quot;:0.01763089906098062,\u0026#92;\u0026quot;dropoff_borough_None\u0026#92;\u0026quot;:0.08335063581314878},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;min\u0026#92;\u0026quot;,\u0026#92;\u0026quot;color_yellow\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;payment_credit card\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;payment_None\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;pickup_borough_Brooklyn\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;pickup_borough_Manhattan\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;pickup_borough_Queens\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;pickup_borough_None\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_borough_Brooklyn\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_borough_Manhattan\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_borough_Queens\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_borough_Staten Island\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_borough_None\u0026#92;\u0026quot;:0.0},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;25%\u0026#92;\u0026quot;,\u0026#92;\u0026quot;color_yellow\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;payment_credit card\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;payment_None\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;pickup_borough_Brooklyn\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;pickup_borough_Manhattan\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;pickup_borough_Queens\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;pickup_borough_None\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_borough_Brooklyn\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_borough_Manhattan\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;dropoff_borough_Queens\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_borough_Staten Island\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_borough_None\u0026#92;\u0026quot;:0.0},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;50%\u0026#92;\u0026quot;,\u0026#92;\u0026quot;color_yellow\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;payment_credit card\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;payment_None\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;pickup_borough_Brooklyn\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;pickup_borough_Manhattan\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;pickup_borough_Queens\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;pickup_borough_None\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_borough_Brooklyn\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_borough_Manhattan\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;dropoff_borough_Queens\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_borough_Staten Island\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_borough_None\u0026#92;\u0026quot;:0.0},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;75%\u0026#92;\u0026quot;,\u0026#92;\u0026quot;color_yellow\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;payment_credit card\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;payment_None\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;pickup_borough_Brooklyn\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;pickup_borough_Manhattan\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;pickup_borough_Queens\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;pickup_borough_None\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_borough_Brooklyn\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_borough_Manhattan\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;dropoff_borough_Queens\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_borough_Staten Island\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;dropoff_borough_None\u0026#92;\u0026quot;:0.0},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;max\u0026#92;\u0026quot;,\u0026#92;\u0026quot;color_yellow\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;payment_credit card\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;payment_None\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;pickup_borough_Brooklyn\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;pickup_borough_Manhattan\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;pickup_borough_Queens\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;pickup_borough_None\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;dropoff_borough_Brooklyn\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;dropoff_borough_Manhattan\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;dropoff_borough_Queens\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;dropoff_borough_Staten Island\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;dropoff_borough_None\u0026#92;\u0026quot;:1.0}]\u0026quot;' data-total-rows='9' data-total-columns='13' data-max-columns='50' data-banner-text='\u0026quot;\u0026quot;' data-pagination='true' data-page-size='30' data-field-types='[[\u0026quot;statistic\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;color_yellow\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;payment_credit card\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;payment_None\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;pickup_borough_Brooklyn\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;pickup_borough_Manhattan\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;pickup_borough_Queens\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;pickup_borough_None\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;dropoff_borough_Brooklyn\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;dropoff_borough_Manhattan\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;dropoff_borough_Queens\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;dropoff_borough_Staten Island\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;dropoff_borough_None\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "d17eaf801bdacabc939fcdcc6b15a85e", "console": [], "id": "iLit", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"standardscaler\"\u003EStandardScaler\u003C/h2\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "3bcaad85e4ab1e1c3e93dc3ad28e4eb3", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "casting (6433, 14) {'pickup': Datetime(time_unit='ms', time_zone=None), 'dropoff': Datetime(time_unit='ms', time_zone=None), 'passengers': Int8, 'distance': Float64, 'fare': Float64, 'tip': Float64, 'tolls': Float64, 'total': Float64, 'color': String, 'payment': String, 'pickup_zone': String, 'dropoff_zone': String, 'pickup_borough': String, 'dropoff_borough': String}\n", "type": "stream"}], "id": "ZHCJ", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='ZHCJ-0' random-id='f16d3d7c-b8ed-5d4a-ebc5-71ceac77aab4'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='\u0026quot;[{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;count\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:6433.0},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;null_count\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:0.0},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;mean\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:-4.362884822403848e-17,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:-5.522639015701074e-18,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:-6.0749029172711816e-18,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:1.8362774727206072e-17,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:-3.644941750362709e-17},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;std\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:1.0000777332971753,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:1.0000777332971753,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:1.0000777332971753,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:1.000077733297175,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:1.000077733297175},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;min\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:-0.790218660199765,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:-1.0467639681646768,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:-0.8083828168678631,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:-0.22984922335423927,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:-1.2463570110357716},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;25%\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:-0.5341815046841254,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:-0.5706108576825231,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:-0.8083828168678631,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:-0.22984922335423927,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:-0.5586735902227205},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;50%\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:-0.36174831831644977,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:-0.31089097923771203,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:-0.11404311102096028,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:-0.22984922335423927,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:-0.31545082244042033},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;75%\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.0484336553157485,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:0.1652621312444416,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.3352355221740944,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:-0.22984922335423927,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:0.12900983059033067},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;max\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:8.798111551457355,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:11.85265666126094,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:12.751663203201064,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:16.743528631241485,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:11.314361639435873}]\u0026quot;' data-total-rows='9' data-total-columns='6' data-max-columns='50' data-banner-text='\u0026quot;\u0026quot;' data-pagination='true' data-page-size='30' data-field-types='[[\u0026quot;statistic\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;distance\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;fare\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;tip\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;tolls\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;total\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "9d12b5c1cf0b6bd4f612c0bda14f7705", "console": [], "id": "ROlb", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"minmaxscaler\"\u003EMinMaxScaler\u003C/h2\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "9d8c1e089edd916162a0e190885d52b6", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "casting (6433, 14) {'pickup': Datetime(time_unit='ms', time_zone=None), 'dropoff': Datetime(time_unit='ms', time_zone=None), 'passengers': Int8, 'distance': Float64, 'fare': Float64, 'tip': Float64, 'tolls': Float64, 'total': Float64, 'color': String, 'payment': String, 'pickup_zone': String, 'dropoff_zone': String, 'pickup_borough': String, 'dropoff_borough': String}\n", "type": "stream"}], "id": "qnkX", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='qnkX-0' random-id='e12f52d7-0ee6-cde4-db64-8a2b482b9270'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='\u0026quot;[{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;count\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:6433.0},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;null_count\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:0.0},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;mean\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.08241462723499529,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:0.0811481382176842,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.059615049659230736,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.013541749045079153,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:0.09922656861587867},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;std\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.10430155316108321,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:0.07752888769405968,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.07375179492879713,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.05892037176479832,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:0.0796194677332115},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;min\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:0.0},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;25%\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.026702997275204355,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:0.03691275167785235,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:0.05474873213462426},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;50%\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.04468664850136239,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:0.05704697986577182,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.051204819277108425,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:0.07411249423697557},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;75%\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.0874659400544959,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:0.09395973154362415,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.08433734939759034,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:0.10949746426924852},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;max\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:0.9999999999999999,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:1.0}]\u0026quot;' data-total-rows='9' data-total-columns='6' data-max-columns='50' data-banner-text='\u0026quot;\u0026quot;' data-pagination='true' data-page-size='30' data-field-types='[[\u0026quot;statistic\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;distance\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;fare\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;tip\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;tolls\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;total\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "a4f355fdd06e8955809e23ff463a7ffe", "console": [], "id": "TqIu", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"robustscaler\"\u003ERobustScaler\u003C/h2\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "de0af6811962af361cb69abe4b5b2730", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "casting (6433, 14) {'pickup': Datetime(time_unit='ms', time_zone=None), 'dropoff': Datetime(time_unit='ms', time_zone=None), 'passengers': Int8, 'distance': Float64, 'fare': Float64, 'tip': Float64, 'tolls': Float64, 'total': Float64, 'color': String, 'payment': String, 'pickup_zone': String, 'dropoff_zone': String, 'pickup_borough': String, 'dropoff_borough': String}\n", "type": "stream"}], "id": "Vxnm", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='Vxnm-0' random-id='2291f214-cb09-aaec-ca93-afe0f702bb97'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='\u0026quot;[{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;count\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:6433.0},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;null_count\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:0.0},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;mean\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.620904403374138,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:0.4224791287570523,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.09972130310230727,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.3252728120628011,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:0.45871517749760693},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;std\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:1.716532287449217,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:1.359035796048811,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.8744855684414519,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:1.4152673297904557,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:1.4542705306386168},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;min\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:-0.7354260089686099,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:-1.0,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:-0.6071428571428572,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:-1.3536842105263158},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;25%\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:-0.2959641255605381,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:-0.35294117647058826,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:-0.6071428571428572,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:-0.3536842105263157},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;50%\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:0.0},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;75%\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.7040358744394619,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:0.6470588235294118,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.39285714285714285,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:0.6463157894736843},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;max\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:15.721973094170405,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:16.529411764705884,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:11.250000000000002,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:24.02,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:16.911578947368422}]\u0026quot;' data-total-rows='9' data-total-columns='6' data-max-columns='50' data-banner-text='\u0026quot;\u0026quot;' data-pagination='true' data-page-size='30' data-field-types='[[\u0026quot;statistic\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;distance\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;fare\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;tip\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;tolls\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;total\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "6fa9f6d6c75dd445308cd400baa4cc5a", "console": [], "id": "DnEU", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"maxabs-scaler\"\u003EMaxAbs Scaler\u003C/h2\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "12f79163e4e1f59afe142eddfa60d225", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "casting (6433, 14) {'pickup': Datetime(time_unit='ms', time_zone=None), 'dropoff': Datetime(time_unit='ms', time_zone=None), 'passengers': Int8, 'distance': Float64, 'fare': Float64, 'tip': Float64, 'tolls': Float64, 'total': Float64, 'color': String, 'payment': String, 'pickup_zone': String, 'dropoff_zone': String, 'pickup_borough': String, 'dropoff_borough': String}\n", "type": "stream"}], "id": "ulZA", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='ulZA-0' random-id='11c2a509-9bc3-da1e-28a7-68cb9d6f0457'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='\u0026quot;[{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;count\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:6433.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:6433.0},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;null_count\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:0.0},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;mean\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.08241462723499529,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:0.08727381729623296,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.059615049659230736,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.013541749045079153,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:0.10592491812279639},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;std\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.10430155316108322,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:0.07701202844276595,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.07375179492879713,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.05892037176479832,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:0.07902739984593787},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;min\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:0.006666666666666667,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:0.007436220112115319},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;25%\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.02670299727520436,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:0.043333333333333335,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:0.06177782862372727},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;50%\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.04468664850136239,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:0.06333333333333334,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.051204819277108425,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:0.08099759752888686},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;75%\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:0.0874659400544959,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:0.1,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:0.08433734939759036,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:0.11611943713533922},{\u0026#92;\u0026quot;statistic\u0026#92;\u0026quot;:\u0026#92;\u0026quot;max\u0026#92;\u0026quot;,\u0026#92;\u0026quot;distance\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;fare\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;tip\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;tolls\u0026#92;\u0026quot;:1.0,\u0026#92;\u0026quot;total\u0026#92;\u0026quot;:1.0}]\u0026quot;' data-total-rows='9' data-total-columns='6' data-max-columns='50' data-banner-text='\u0026quot;\u0026quot;' data-pagination='true' data-page-size='30' data-field-types='[[\u0026quot;statistic\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;distance\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;fare\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;tip\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;tolls\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]],[\u0026quot;total\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;f64\u0026quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "68574d0a14ec4b4dd53438426781aa1f", "console": [], "id": "ecfG", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"conclusion\"\u003EConclusion\u003C/h1\u003E\n\u003Cul\u003E\n\u003Cli\u003EActually with this code it's better to use Scikit-Learn preprocessing\u003C/li\u003E\n\u003Cli\u003EProbably in feature, i will find another way to be faster with Polars\u003C/li\u003E\n\u003C/ul\u003E\u003C/span\u003E"}, "type": "data"}]}], "metadata": {"marimo_version": "0.18.4"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.18.4%22%0Aapp%20%3D%20marimo.App(width%3D%22full%22%2C%20sql_output%3D%22native%22)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20import%20polars%20as%20pl%0A%20%20%20%20from%20sklearn.preprocessing%20import%20MinMaxScaler%2CStandardScaler%2C%20RobustScaler%2CNormalizer%2CMaxAbsScaler%0A%20%20%20%20from%20sklearn.preprocessing%20import%20OneHotEncoder%2C%20OrdinalEncoder%0A%20%20%20%20from%20functools%20import%20wraps%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20MaxAbsScaler%2C%0A%20%20%20%20%20%20%20%20MinMaxScaler%2C%0A%20%20%20%20%20%20%20%20OneHotEncoder%2C%0A%20%20%20%20%20%20%20%20OrdinalEncoder%2C%0A%20%20%20%20%20%20%20%20RobustScaler%2C%0A%20%20%20%20%20%20%20%20StandardScaler%2C%0A%20%20%20%20%20%20%20%20mo%2C%0A%20%20%20%20%20%20%20%20pl%2C%0A%20%20%20%20%20%20%20%20wraps%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20Loading%20DataSet%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(pl)%3A%0A%20%20%20%20pf%20%3D%20pl.read_parquet(%22datasets%2Ftaxis_str.parquet%22)%0A%20%20%20%20pf.describe()%0A%20%20%20%20return%20(pf%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Detect%20which%20encoder%20Ordinal%20or%20OneHot%0A%20%20%20%20*%20Try%20feature.n_unique%20%3C%2010%20%3D%3E%20OneHot%0A%20%20%20%20*%20Try%20feature.n_unique%20%3E%2010%20%3D%3E%20Ordinal%0A%0A%20%20%20%20%3E%20Warning%20%3A%20it%20depend%20nature%20of%20the%20feature%2C%20be%20carefull%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(pf%2C%20pl)%3A%0A%20%20%20%20pf.select(pl.all().n_unique())%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20Preprocessing%0A%20%20%20%20*%20Casting%20%3A%20to%20define%20best%20type%20feature%0A%20%20%20%20*%20Encoders%20%3A%20Onehot%2C%20Ordinal%0A%20%20%20%20*%20Scalers%20%3A%20MinMax%2C%20MaxAbs%2C%20Robust%2C%20Standard%0A%20%20%20%20*%20Drop%20non%20numerical%20features%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(pl%2C%20wraps)%3A%0A%20%20%20%20def%20logshow(func)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20decorator%20for%20function%20transformation%0A%20%20%20%20%20%20%20%20%20%20%20%20using%20wraps%20decorator%20to%20get%20args%20and%20kwargs%20from%20function%0A%20%20%20%20%20%20%20%20%20%20%20%20out%20is%20displaying%20function%20name%2C%20dataframe%20shape%2C%20columns%20name%20and%20dtypes%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%40wraps(func)%0A%20%20%20%20%20%20%20%20def%20wrapper(*args%2C**kwargs)%3A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20ret%20%3D%20func(*args%2C**kwargs)%0A%20%20%20%20%20%20%20%20%20%20%20%20print(func.__name__%2Cret.shape%2Cdict(zip(ret.columns%2Cret.dtypes)))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20ret%0A%20%20%20%20%20%20%20%20return%20wrapper%0A%0A%0A%20%20%20%20%40logshow%0A%20%20%20%20def%20casting(_df%3Apl.DataFrame)-%3Epl.DataFrame%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20Features%20typing%0A%20%20%20%20%20%20%20%20%20%20%20%20Parameters%20%3A%20_df%20%3D%20DataFrame%20polars%0A%20%20%20%20%20%20%20%20%20%20%20%20Returns%20%3A%20DataFrame%20polars%20with%20correct%20type%20%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20return(_df%0A%20%20%20%20%20%20%20%20%20%20%20%20.cast(%7B'passengers'%3Apl.Int8%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20.with_columns(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pl.col(%5B'distance'%2C'fare'%2C'tip'%2C'tolls'%2C'total'%5D).cast(pl.Float64)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pl.col(%5B'pickup'%2C'dropoff'%5D).str.slice(0%2C23).str.strptime(pl.Datetime(time_unit%3D'ms')%2C%22%25Y-%25m-%25d%20%25H%3A%25M%3A%25S.%253f%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20)%20%20%20%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%40logshow%0A%20%20%20%20def%20select_by_nunique(_df%3Apl.DataFrame%2C_condition%3Astr%2C_threshold%3Aint)-%3Epl.DataFrame%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20Selection%20columns%20names%20diffrent%20condition%20threshold%0A%20%20%20%20%20%20%20%20%20%20%20%20Parameters%20%3A%20_df%20%3D%20DataFrame%20polars%2C%20_threshold%20%3D%20nunique%20value%0A%20%20%20%20%20%20%20%20%20%20%20%20Returns%20%3A%20DataFrame%20polars%20with%20correct%20type%20%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20match%20_condition%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20'%3C'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return(_df.select(_df.select(pl.all().n_unique()).unpivot(index%3DNone%2Con%3D_df.columns).filter(pl.col('value')%20%3C%20_threshold).to_series(0).to_list()))%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20'%3C%3D'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return(_df.select(_df.select(pl.all().n_unique()).unpivot(index%3DNone%2Con%3D_df.columns).filter(pl.col('value')%20%3C%3D%20_threshold).to_series(0).to_list()))%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20'%3E'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return(_df.select(_df.select(pl.all().n_unique()).unpivot(index%3DNone%2Con%3D_df.columns).filter(pl.col('value')%20%3E%20_threshold).to_series(0).to_list()))%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20'%3E%3D'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return(_df.select(_df.select(pl.all().n_unique()).unpivot(index%3DNone%2Con%3D_df.columns).filter(pl.col('value')%20%3E%3D%20_threshold).to_series(0).to_list()))%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20'%3D'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return(_df.select(_df.select(pl.all().n_unique()).unpivot(index%3DNone%2Con%3D_df.columns).filter(pl.col('value')%20%3D%3D%20_threshold).to_series(0).to_list()))%0A%0A%20%20%20%20%40logshow%20%20%20%20%0A%20%20%20%20def%20exclude_by_dtypes_cols(_df%3Apl.DataFrame%2C_dtypes%3Alist%5Bpl.DataType%5D)-%3Epl.DataFrame%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20Exclude%20columns%20by%20dtypes%0A%20%20%20%20%20%20%20%20%20%20%20%20Parameters%20%3A%20_df%20%3D%20polars%20DataFrame%2C%20_dtypes%20%3D%20list%20polars%20DataType%0A%20%20%20%20%20%20%20%20%20%20%20%20Returns%20%3A%20DataFrame%20polars%20without%20ecluded%20columns%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20return(_df%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.select(pl.all().exclude(_dtypes))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%23%23%23%20ENCODERS%0A%0A%20%20%20%20%40logshow%0A%20%20%20%20def%20ordinal_encoder(_df%3Apl.DataFrame%2C_to_encode%3Astr)-%3Epl.DataFrame%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20Basic%20encoder%20based%20from%20position%20unique%20values%20(row%20index)%0A%20%20%20%20%20%20%20%20%20%20%20%20Parameters%20%3A%20_df%20%3D%20DataFrame%20polars%2C%20_to_encode%20%3D%20name%20of%20feature%0A%20%20%20%20%20%20%20%20%20%20%20%20Returns%20%3A%20polars%20DataFrame%20with%20new%20colomn%20ordinal%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20return(_df%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.join(_df%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.select(pl.col(_to_encode).unique(maintain_order%3DTrue))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.with_row_index(name%3D_to_encode%2B'_ordinal')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2C%20on%3D_to_encode)%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%40logshow%0A%20%20%20%20def%20value_count_encoder(_df%3Apl.DataFrame%2C_to_encode%3Astr%2C_descending%3Abool%3DTrue%2C_start%3Aint%3D1)-%3Epl.DataFrame%3A%0A%20%20%20%20%20%20%20%20'''%0A%20%20%20%20%20%20%20%20%20%20%20%20Based%20encoder%20from%20value_counts%2C%20the%20greatest%20have%20the%20biggest%20value%0A%20%20%20%20%20%20%20%20%20%20%20%20Parameters%20%3A%20_df%20%3D%20DataFrame%20polars%2C%20_to_encode%20%3D%20name%20of%20feature%2C%20_descending%20%3D%20Smallest%20first%20(True)%20and%20Greatest%20first%20(False)%2C%20_start%20%3D%20start%20ordering%20from%201%20or%20other%20int%0A%20%20%20%20%20%20%20%20%20%20%20%20Returns%20%3A%20polars%20DataFrame%20with%20new%20colomn%20ordinal%0A%20%20%20%20%20%20%20%20'''%0A%20%20%20%20%20%20%20%20return(_df%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.join(_df%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.select(pl.col(_to_encode).value_counts()).unnest(_to_encode)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.sort(by%3D'count'%2Cdescending%3D_descending)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.with_row_index(offset%3D_start%2Cname%3D_to_encode%2B'_vc_ordinal')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2C%20on%20%3D%20_to_encode)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.drop('count')%0A%20%20%20%20%20%20%20%20)%0A%0A%0A%0A%20%20%20%20%40logshow%0A%20%20%20%20def%20onehot_encoder(_df%3Apl.DataFrame%2C_to_encode%3Astr%2C_dropfirst%3Abool%3DTrue)-%3Epl.DataFrame%3A%0A%20%20%20%20%20%20%20%20'''%0A%20%20%20%20%20%20%20%20%20%20%20%20Encode%20each%20class%20from%20the%20feature%20with%20value%200%20or%201%0A%20%20%20%20%20%20%20%20%20%20%20%20Parameters%20%3A%20_df%20%3D%20DataFrame%20polars%2C%20_to_encode%20%3D%20name%20of%20feature%2C%20_dropfitst%20%3D%20remove%201%20class%20to%20reduce%20bias%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20Returns%20%3A%20polars%20DataFrame%20with%20several%20columns%20for%20each%20class%20%20%0A%20%20%20%20%20%20%20%20'''%0A%20%20%20%20%20%20%20%20return(_df%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.with_row_index()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.join(_df.select(pl.col(_to_encode)).to_dummies(drop_first%3D_dropfirst).with_row_index()%2Con%20%3D%20'index')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.drop('index')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%23%23%23%20SCALERS%20%0A%0A%20%20%20%20NUMERICS_DTYPES%20%3D%20pl.selectors.by_dtype(%5Bpl.Float16%2Cpl.Float32%2Cpl.Float64%5D)%0A%0A%20%20%20%20%40logshow%0A%20%20%20%20def%20standard_scaler(_df%3Apl.DataFrame%2C_col%3Astr)-%3Epl.DataFrame%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20Standard%20Scaler%20X%20-%20mean%20%2F%20std%0A%20%20%20%20%20%20%20%20%20%20%20%20Parameters%20%3A%20_df%20%3D%20polars%20DataFrame%2C%20_col%20%3D%20feature%20name%20frome%20a%20mesure%0A%20%20%20%20%20%20%20%20%20%20%20%20Returns%20%3A%20DataFrame%20polars%20with%20new%20_standard%20column%0A%20%20%20%20%20%20%20%20%22%22%22%0A%0A%20%20%20%20%20%20%20%20return(_df%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.with_columns(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pl.col(_col)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.map_batches(lambda%20x%3A%20(x%20-x.mean())%2Fx.std(ddof%3D1)%2Creturn_dtype%3Dpl.Float64)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.alias(_col%2B'_standard')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%0A%0A%20%20%20%20%40logshow%0A%20%20%20%20def%20minmax_scaler(_df%3Apl.DataFrame%2C_col%3Astr)-%3Epl.DataFrame%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20Min%20Max%20Scaler%20X%20-%20min%20%2F%20max%20-%20min%0A%20%20%20%20%20%20%20%20%20%20%20%20Parameters%20%3A%20_df%20%3D%20polars%20DataFrame%2C%20_col%20%3D%20feature%20name%20frome%20a%20mesure%0A%20%20%20%20%20%20%20%20%20%20%20%20Returns%20%3A%20DataFrame%20polars%20with%20new%20_minmax%20column%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20return(_df%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.with_columns(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pl.col(_col)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.map_batches(lambda%20x%3A%20(x%20-%20x.min())%2F(x.max()-x.min())%2Creturn_dtype%3Dpl.Float64)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.alias(_col%2B'_minmax')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%40logshow%0A%20%20%20%20def%20maxabs_scaler(_df%3Apl.DataFrame%2C_col%3Astr)-%3Epl.DataFrame%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20Max%20abs%20Scaler%20X%20%2F%20max%20absolute%0A%20%20%20%20%20%20%20%20%20%20%20%20Parameters%20%3A%20_df%20%3D%20polars%20DataFrame%2C%20_col%20%3D%20feature%20name%20frome%20a%20mesure%0A%20%20%20%20%20%20%20%20%20%20%20%20Returns%20%3A%20DataFrame%20polars%20with%20new%20_maxabs%20column%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20return(_df%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.with_columns(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pl.col(_col)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.map_batches(lambda%20x%3A%20(x%2Fx.abs().max())%2Creturn_dtype%3Dpl.Float64)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.alias(_col%2B'_maxabs')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%0A%20%20%20%20%40logshow%0A%20%20%20%20def%20robust_scaler(_df%3Apl.DataFrame%2C_col%3Astr)-%3Epl.DataFrame%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20Robust%20Scaler%20X%20-%20median%20%2F%20q3%20-%20q1%0A%20%20%20%20%20%20%20%20%20%20%20%20Parameters%20%3A%20_df%20%3D%20polars%20DataFrame%2C%20_col%20%3D%20feature%20name%20frome%20a%20mesure%0A%20%20%20%20%20%20%20%20%20%20%20%20Returns%20%3A%20DataFrame%20polars%20with%20new%20_robust%20column%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20return(_df%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.with_columns(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pl.col(_col).map_batches(lambda%20x%3A%20(x-x.median())%2F(x.quantile(.75)-x.quantile(.25))%2Creturn_dtype%3Dpl.Float64)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.alias(_col%2B'_robust')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20NUMERICS_DTYPES%2C%0A%20%20%20%20%20%20%20%20casting%2C%0A%20%20%20%20%20%20%20%20exclude_by_dtypes_cols%2C%0A%20%20%20%20%20%20%20%20onehot_encoder%2C%0A%20%20%20%20%20%20%20%20select_by_nunique%2C%0A%20%20%20%20%20%20%20%20standard_scaler%2C%0A%20%20%20%20%20%20%20%20value_count_encoder%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Piepline%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20casting%2C%0A%20%20%20%20exclude_by_dtypes_cols%2C%0A%20%20%20%20onehot_encoder%2C%0A%20%20%20%20pf%2C%0A%20%20%20%20pl%2C%0A%20%20%20%20standard_scaler%2C%0A%20%20%20%20value_count_encoder%2C%0A)%3A%0A%0A%20%20%20%20(pf%0A%20%20%20%20%20%20%20%20.pipe(casting)%0A%20%20%20%20%20%20%20%20.pipe(onehot_encoder%2C'color')%0A%20%20%20%20%20%20%20%20.pipe(onehot_encoder%2C'payment')%0A%20%20%20%20%20%20%20%20.pipe(value_count_encoder%2C'pickup_borough')%0A%20%20%20%20%20%20%20%20.pipe(standard_scaler%2C'distance')%0A%20%20%20%20%20%20%20%20.pipe(standard_scaler%2C'fare')%0A%20%20%20%20%20%20%20%20.pipe(exclude_by_dtypes_cols%2C%5Bpl.Datetime%2Cpl.String%5D)%20%0A%20%20%20%20%20%20%20%20%23.describe()%0A%20%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20Checking%20preprocessing%20with%20Scklearn%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Ordinal%20Encoder%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20OrdinalEncoder%2C%0A%20%20%20%20casting%2C%0A%20%20%20%20exclude_by_dtypes_cols%2C%0A%20%20%20%20pf%2C%0A%20%20%20%20pl%2C%0A%20%20%20%20select_by_nunique%2C%0A)%3A%0A%20%20%20%20ordinal_enc%20%3D%20OrdinalEncoder()%0A%20%20%20%20(pl.DataFrame(ordinal_enc.fit_transform(pf.pipe(casting).pipe(exclude_by_dtypes_cols%2C%5Bpl.Int8%2Cpl.Datetime%2Cpl.Float64%5D).pipe(select_by_nunique%2C'%3E'%2C10))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20schema%3Dlist(ordinal_enc.get_feature_names_out())%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20orient%3D'row')%0A%20%20%20%20%20%20%20%20.describe()%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20OneHot%20Encoder%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20OneHotEncoder%2C%0A%20%20%20%20casting%2C%0A%20%20%20%20exclude_by_dtypes_cols%2C%0A%20%20%20%20pf%2C%0A%20%20%20%20pl%2C%0A%20%20%20%20select_by_nunique%2C%0A)%3A%0A%20%20%20%20onehot_enc%20%3D%20OneHotEncoder(drop%3D'first'%2Csparse_output%3DFalse)%0A%0A%0A%20%20%20%20(pl.DataFrame(onehot_enc.fit_transform(pf.pipe(casting).pipe(exclude_by_dtypes_cols%2C%5Bpl.Int8%5D).pipe(select_by_nunique%2C'%3C'%2C10))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20schema%3Dlist(onehot_enc.get_feature_names_out())%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20orient%3D'row')%0A%20%20%20%20%20%20%20%20.describe()%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20StandardScaler%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(NUMERICS_DTYPES%2C%20StandardScaler%2C%20casting%2C%20pf%2C%20pl)%3A%0A%20%20%20%20sk_std_scaler%20%3D%20StandardScaler()%0A%20%20%20%20(pl.DataFrame(data%3Dsk_std_scaler.fit_transform(pf.pipe(casting).select(%5BNUMERICS_DTYPES%5D))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20schema%3Dlist(sk_std_scaler.get_feature_names_out())%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20orient%3D'row')%0A%20%20%20%20%20%20%20%20.describe()%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20MinMaxScaler%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(MinMaxScaler%2C%20NUMERICS_DTYPES%2C%20casting%2C%20pf%2C%20pl)%3A%0A%20%20%20%20sk_minmax_scaler%20%3D%20MinMaxScaler()%0A%20%20%20%20(pl.DataFrame(data%3Dsk_minmax_scaler.fit_transform(pf.pipe(casting).select(%5BNUMERICS_DTYPES%5D))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20schema%3Dlist(sk_minmax_scaler.get_feature_names_out())%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20orient%3D'row')%0A%20%20%20%20%20%20%20%20.describe()%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20RobustScaler%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(NUMERICS_DTYPES%2C%20RobustScaler%2C%20casting%2C%20pf%2C%20pl)%3A%0A%20%20%20%20sk_robust_scaler%20%3D%20RobustScaler()%0A%20%20%20%20(pl.DataFrame(data%3Dsk_robust_scaler.fit_transform(pf.pipe(casting).select(%5BNUMERICS_DTYPES%5D))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20schema%3Dlist(sk_robust_scaler.get_feature_names_out())%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20orient%3D'row')%0A%20%20%20%20%20%20%20%20.describe()%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20MaxAbs%20Scaler%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(MaxAbsScaler%2C%20NUMERICS_DTYPES%2C%20casting%2C%20pf%2C%20pl)%3A%0A%20%20%20%20sk_maxabs_scaler%20%3D%20MaxAbsScaler()%0A%20%20%20%20(pl.DataFrame(data%3Dsk_maxabs_scaler.fit_transform(pf.pipe(casting).select(%5BNUMERICS_DTYPES%5D))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20schema%3Dlist(sk_maxabs_scaler.get_feature_names_out())%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20orient%3D'row')%0A%20%20%20%20%20%20%20%20.describe()%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20Conclusion%0A%0A%20%20%20%20*%20Actually%20with%20this%20code%20it's%20better%20to%20use%20Scikit-Learn%20preprocessing%0A%20%20%20%20*%20Probably%20in%20feature%2C%20i%20will%20find%20another%20way%20to%20be%20faster%20with%20Polars%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">98ae7e06dde9e36c0cca3e77e5db8d2b</marimo-code-hash>
</body>
</html>
